<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Cloning virtual machines in vSphere series – Part 2: Full clone | IT Gaiden</title>
<meta name="keywords" content="clones, cloning, full clone, PowerCLI, VMware, vSphere" />
<meta name="description" content="Continuing with the cloning virtual machines in vSphereseries, today I am going to write about the full clone, how it works and some useful information about it.So, let’s talk about clones… but just full clones.How does it work? As you probably know a full clone is an exact copy of a source VM, meaning that, everything from the parent VM is copied (VM settings, disks, files, etc.).This action can be performed if the parent VM is powered off or powered onand, if it has snapshots it will consolidate them once the clone is done.">
<meta name="author" content="itgaiden">
<link rel="canonical" href="https://dangaiden.github.io/?p=591/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.35cd0f65a15cafa92372b8313deef5960aae04b90ad722f2bbf509eb0468137e.css" integrity="sha256-Nc0PZaFcr6kjcrgxPe71lgquBLkK1yLyu/UJ6wRoE34=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://dangaiden.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://dangaiden.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://dangaiden.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://dangaiden.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://dangaiden.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.85.0" />
<meta property="og:title" content="Cloning virtual machines in vSphere series – Part 2: Full clone" />
<meta property="og:description" content="Continuing with the cloning virtual machines in vSphereseries, today I am going to write about the full clone, how it works and some useful information about it.So, let’s talk about clones… but just full clones.How does it work? As you probably know a full clone is an exact copy of a source VM, meaning that, everything from the parent VM is copied (VM settings, disks, files, etc.).This action can be performed if the parent VM is powered off or powered onand, if it has snapshots it will consolidate them once the clone is done." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dangaiden.github.io/?p=591/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-06T11:00:54&#43;00:00" />
<meta property="article:modified_time" content="2019-03-06T11:00:54&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cloning virtual machines in vSphere series – Part 2: Full clone"/>
<meta name="twitter:description" content="Continuing with the cloning virtual machines in vSphereseries, today I am going to write about the full clone, how it works and some useful information about it.So, let’s talk about clones… but just full clones.How does it work? As you probably know a full clone is an exact copy of a source VM, meaning that, everything from the parent VM is copied (VM settings, disks, files, etc.).This action can be performed if the parent VM is powered off or powered onand, if it has snapshots it will consolidate them once the clone is done."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://dangaiden.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Cloning virtual machines in vSphere series – Part 2: Full clone",
      "item": "https://dangaiden.github.io/?p=591/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Cloning virtual machines in vSphere series – Part 2: Full clone",
  "name": "Cloning virtual machines in vSphere series – Part 2: Full clone",
  "description": "Continuing with the cloning virtual machines in vSphereseries, today I am going to write about the full clone, how it works and some useful information about it.So, let’s talk about clones… but just full clones.How does it work? As you probably know a full clone is an exact copy of a source VM, meaning that, everything from the parent VM is copied (VM settings, disks, files, etc.).This action can be performed if the parent VM is powered off or powered onand, if it has snapshots it will consolidate them once the clone is done.",
  "keywords": [
    "clones", "cloning", "full clone", "PowerCLI", "VMware", "vSphere"
  ],
  "articleBody": "Continuing with the cloning virtual machines in vSphereseries, today I am going to write about the full clone, how it works and some useful information about it.So, let’s talk about clones… but just full clones.How does it work? As you probably know a full clone is an exact copy of a source VM, meaning that, everything from the parent VM is copied (VM settings, disks, files, etc.).This action can be performed if the parent VM is powered off or powered onand, if it has snapshots it will consolidate them once the clone is done.When you clone a VM be aware that, all data will be identical so, if you power on the clone without performing any customization, probably you will have conflicts with IPs, MAC addresses, SIDs (Windows), etc.The great thing about a full clone is that, after the cloning operations are performed the clone will be an independent copy of a virtual machine that doesn’t share anything with the parent virtual machine (we are talking about from a computeand storage perspective within vSphere).Ways to do it First of all, you will need VMware vCenter to do it. There are other ways (not official) like copying all data related to the virtual machine (.vmdk and .vmx files) and then register the «new» VM with another name.Let’s continue with the usual ways:vSphere Web Client You can do it through vSphere Web Client, as simple as, right-click a VM - «Clone to Virtual Machine…» :Once it finishes, it takes some time (depends on the storage that the source VM has allocated) but in the end, you will have your new clone.Likely you are more familiar about deploying templates…Deploying a template is the same as cloning but. aside from copying the same data from the parent virtual machine, vSphere lets you customize the deployed VM for creating many clones and with different configurations as you wish.PowerCLI Of course, you can do it with PowerCLI. These are the minimal parameters needed to perform it (Disk Storage Formatparameter is optional but recommended because, by default, it will convert all disks to Thick Provision Eager Zeroed):New-VM -Name  -VMHost  -VM  [-DiskStorageFormat ]\nIn the previous screenshot, you can see the minimum parameters required to perform a full clone, if you want to see more options you can check it here.As you can see in the code, it’s similar to deploying a template, isn’t it?Use cases The main use case is deploying from a template, maybe we are not aware but, deploying from a template is just cloning our source VM (Master template) and then customizing it.I saw many customers use it as a «rollback»when they have to perform a destructive task within the Guest OS. In this way, just shutting down the parent VM and powering on the clone.If you think a snapshot can do the same as a clone well, not always… some applications don’t handle well doing a quiesced snapshot.This is why, as a solution, you can create a full clone when the virtual machine is powered off and then, have a copy that will be consistent and without corruption.Another use case could be to perform a full clone to use it in other environments. Although there are better ways to do this (with other products), when the Guest OS has many customizations, this can be an alternative solution of re-creating the entire virtual machine.Benefits and limitations The benefitsof a full clone were mentioned before:  If the cloning operation is executed when the source VM is powered off, it can be used as a rollback in many cases (there are better options like a VM backup but, it can help a lot). Creation of an independent VM that shares nothing with the source VM.  Used in templates, so, they are very useful!  These are some limitationsinstead of disadvantages that we can find: It takes some time to create a full clone (it depends on the allocated storage) as it has to copy all storage from the source VM. It can only be performed with VMware vCenter (there are other ways as I explained before but they are not official). If done when the VM is powered on, it has an impact on the source VM that can be noticed by the business so, isn’t the best option to do it while the virtual machine is in running.   Conclusion To sum up, a full clone is a great way to have an identical copy of another VM to use it as a permanent virtual machine once you configure it accordingly.As said before, is the same as deploying a template because you are just cloning a VM (deploying a template) and then customizing it. It usually takes some minutes to finish the clone (depending on the storage allocated in the parent VM), this is why there are other ways to deploy clones in a faster way (on the next posts!).",
  "wordCount" : "824",
  "inLanguage": "en",
  "datePublished": "2019-03-06T11:00:54Z",
  "dateModified": "2019-03-06T11:00:54Z",
  "author":{
    "@type": "Person",
    "name": "itgaiden"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://dangaiden.github.io/?p=591/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "IT Gaiden",
    "logo": {
      "@type": "ImageObject",
      "url": "https://dangaiden.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://dangaiden.github.io" accesskey="h" title="IT Gaiden (Alt + H)">IT Gaiden</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Cloning virtual machines in vSphere series – Part 2: Full clone
    </h1>
    <div class="post-meta">March 6, 2019&nbsp;·&nbsp;itgaiden
</div>
  </header> 
  <div class="post-content"><p><!-- raw HTML omitted -->Continuing with the <!-- raw HTML omitted -->cloning virtual machines in vSphere<!-- raw HTML omitted --> series, today I am going to write about the full clone, how it works and some useful information about it.<!-- raw HTML omitted --> <!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->So, let’s talk about clones… but just full clones.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --></p>
<h3 id="span-stylefont-size-24px-font-family-didact-gothichow-does-it-workspan"><strong><!-- raw HTML omitted -->How does it work?<!-- raw HTML omitted --></strong><a hidden class="anchor" aria-hidden="true" href="#span-stylefont-size-24px-font-family-didact-gothichow-does-it-workspan">#</a></h3>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->As you probably know a <!-- raw HTML omitted -->f<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->ull c<!-- raw HTML omitted -->lone is an exact copy of a source VM<!-- raw HTML omitted -->, meaning that, everything from the parent VM is copied (VM settings, disks, files, etc.).<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->This action can be performed if the <!-- raw HTML omitted -->parent VM is powered off or powered on<!-- raw HTML omitted --> and, if it has snapshots it will consolidate them once the clone is done.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->When you clone a VM be aware that, all data will be identical so, if you power on the clone without performing any customization, probably you will have conflicts with IPs, MAC addresses, SIDs (Windows), etc.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->The great thing about a full clone is that, after the cloning operations are performed the clone will be an independent copy of a virtual machine that doesn’t share anything with the parent virtual machine (we are talking about from a <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->compute<!-- raw HTML omitted --> and storage perspective within vSphere).<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="span-stylefont-family-didact-gothicstrongways-to-do-itstrongspan"><!-- raw HTML omitted --><!-- raw HTML omitted -->Ways to do it<!-- raw HTML omitted --><!-- raw HTML omitted --><a hidden class="anchor" aria-hidden="true" href="#span-stylefont-family-didact-gothicstrongways-to-do-itstrongspan">#</a></h3>
<p><!-- raw HTML omitted -->First of all, you will need VMware vCenter to do it. <!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->There are other ways (not official) like copying all data related to the virtual machine (.vmdk and .vmx files) and then register the «new» VM with another name.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Let’s continue with the usual ways:<!-- raw HTML omitted --></p>
<h4 id="span-stylefont-family-didact-gothicvsphere-web-clientspan"><!-- raw HTML omitted -->vSphere Web Client<!-- raw HTML omitted --><a hidden class="anchor" aria-hidden="true" href="#span-stylefont-family-didact-gothicvsphere-web-clientspan">#</a></h4>
<p><!-- raw HTML omitted -->You can do it through vSphere Web Client, as simple as, right-click a VM -&gt; «Clone to Virtual Machine…» :<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Once it finishes, it takes some time (depends on the storage that the source VM has allocated) but in the end, you will have your new clone.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Likely you are more familiar about deploying templates…<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Deploying a template is the same as cloning but. aside from copying the same data from the parent virtual machine, vSphere lets you customize the deployed VM for creating many clones and with different configurations as you wish.<!-- raw HTML omitted --></p>
<h4 id="span-stylefont-size-20px-font-family-didact-gothicpowerclispan"><!-- raw HTML omitted -->PowerCLI<!-- raw HTML omitted --><a hidden class="anchor" aria-hidden="true" href="#span-stylefont-size-20px-font-family-didact-gothicpowerclispan">#</a></h4>
<p><!-- raw HTML omitted -->Of course, you can do it with PowerCLI. These are the minimal parameters needed to perform it (<!-- raw HTML omitted -->Disk Storage Format<!-- raw HTML omitted --> parameter is optional but recommended because, by default, it will convert all disks to Thick Provision Eager Zeroed):<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><code>&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;background-color: #999999;&quot;&gt;&lt;span style=&quot;background-color: #c7c7c7;&quot;&gt;&lt;span style=&quot;background-color: #e8e8e8;&quot;&gt;&lt;strong&gt;New-VM -Name &lt;CloneName&gt; -VMHost &lt;VMHost&gt; -VM &lt;VirtualMachineSourceVM&gt; [-DiskStorageFormat &lt;VirtualDiskStorageFormat&gt;]&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</code></p>
<p><!-- raw HTML omitted -->In the previous screenshot, you can see the minimum parameters required to perform a full clone, if you want to see more options you can check it <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->here<!-- raw HTML omitted -->.<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->As you can see in the code, it’s similar to deploying a template, isn’t it?<!-- raw HTML omitted --></p>
<h3 id="span-stylefont-family-didact-gothicuse-casesspan"><strong><!-- raw HTML omitted -->Use cases<!-- raw HTML omitted --></strong><a hidden class="anchor" aria-hidden="true" href="#span-stylefont-family-didact-gothicuse-casesspan">#</a></h3>
<p><!-- raw HTML omitted -->The main use case is <!-- raw HTML omitted -->deploying from a template<!-- raw HTML omitted -->, maybe we are not aware but, deploying from a template is just cloning our source VM (Master template) and then customizing it.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->I saw many customers <!-- raw HTML omitted -->use it as a «rollback»<!-- raw HTML omitted --> when they have to perform a destructive task within the Guest OS. In this way, just shutting down the parent VM and powering on the clone.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->If you think a snapshot can do the same as a clone well, not always… some applications don’t handle well doing a quiesced snapshot.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->This is why, as a solution, you can create a full clone when the virtual machine is powered off and then, have a copy that will be consistent and without corruption.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->Another use case could be to perform a full clone to <!-- raw HTML omitted -->use it in other environments<!-- raw HTML omitted -->. Although there are better ways to do this (with other products), when the Guest OS has many customizations, this can be an alternative solution of re-creating the entire virtual machine.<!-- raw HTML omitted --></p>
<h3 id="span-stylefont-family-didact-gothicstrongbenefits-and-limitationsstrongbr--span"><!-- raw HTML omitted --><!-- raw HTML omitted -->Benefits and limitations<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><a hidden class="anchor" aria-hidden="true" href="#span-stylefont-family-didact-gothicstrongbenefits-and-limitationsstrongbr--span">#</a></h3>
<p><!-- raw HTML omitted -->The <!-- raw HTML omitted -->benefits<!-- raw HTML omitted --> of a full clone were mentioned before: <!-- raw HTML omitted --></p>
<ul>
<li><!-- raw HTML omitted -->If the cloning operation is executed when the source VM is powered off, it can be used as a rollback in many cases (there are better options like a VM backup but, it can help a lot).<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->Creation of an independent VM that shares nothing with the source VM. <!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->Used in templates, so, they are very useful!<!-- raw HTML omitted --></li>
</ul>
<p><!-- raw HTML omitted -->These are some <!-- raw HTML omitted -->limitations<!-- raw HTML omitted --> instead of disadvantages that we can find:<!-- raw HTML omitted --></p>
<ul>
<li><!-- raw HTML omitted -->It takes some time to create a full clone (it depends on the allocated storage) as it has to copy all storage from the source VM.<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->It can only be performed with VMware vCenter (there are other ways as I explained before but they are not official).<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->If done when the VM is powered on, it has an impact on the source VM that can be noticed by the business so, isn’t the best option to do it while the virtual machine is in running.<!-- raw HTML omitted --></li>
</ul>
<h3 id="heading"><a hidden class="anchor" aria-hidden="true" href="#heading">#</a></h3>
<h3 id="span-stylefont-family-didact-gothicconclusionspan"><strong><!-- raw HTML omitted -->Conclusion<!-- raw HTML omitted --></strong><a hidden class="anchor" aria-hidden="true" href="#span-stylefont-family-didact-gothicconclusionspan">#</a></h3>
<p><!-- raw HTML omitted -->To sum up, a full clone is a great way to have an identical copy of another VM to use it as a permanent virtual machine once you configure it accordingly.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->As said before, is the same as deploying a template because you are just cloning a VM (deploying a template) and then customizing it. <!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->It usually takes some minutes to finish the clone (depending on the storage allocated in the parent VM), this is why there are other ways to deploy clones in a faster way (on the next posts!).<!-- raw HTML omitted --></p>


  </div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://dangaiden.github.io/tags/clones/">clones</a></li>
      <li><a href="https://dangaiden.github.io/tags/cloning/">cloning</a></li>
      <li><a href="https://dangaiden.github.io/tags/full-clone/">full clone</a></li>
      <li><a href="https://dangaiden.github.io/tags/powercli/">PowerCLI</a></li>
      <li><a href="https://dangaiden.github.io/tags/vmware/">VMware</a></li>
      <li><a href="https://dangaiden.github.io/tags/vsphere/">vSphere</a></li>
    </ul>
  </footer>
</article>
    </main>
    <footer class="footer">
    <span>&copy; 2021 <a href="https://dangaiden.github.io">IT Gaiden</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
